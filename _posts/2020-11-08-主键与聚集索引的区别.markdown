---

layout: post

title:  "主键与聚集索引区别"

date:   2020-11-08 14:00:00 +0800

categories: mysql

---

<br>

#### 1. 主键（PRIMARY KEY ）

> 唯一索引实际上就是要求指定的列中所有的数据必须不同

表通常具有包含唯一标识表中每一行的值的一列或一组列。这样的一列或多列称为表的**主键 (PK)**，用于强制表的实体完整性。在创建或修改表时，您可以通过定义`PRIMARY KEY` 约束来创建**主键**。

一个表只能有一个 `PRIMARY KEY` 约束，并且 `PRIMARY KEY` 约束中的列不能接受空值。由于 `PRIMARY KEY` 约束可保证数据的唯一性，因此经常对标识列定义这种约束。

如果为表指定了 `PRIMARY KEY` 约束，则 SQL Server 2005 数据库引擎将通过为**主键列**创建**唯一索引**来强制数据的唯一性。当在查询中使用**主键**时，此索引还可用来对数据进行快速访问。因此，所选的**主键**必须遵守创建唯一索引的规则。 

创建**主键**时，数据库引擎会自动创建唯一的索引来强制实施 `PRIMARY KEY` 约束的唯一性要求。如果表中不存在**聚集索引**或未显式指定**非聚集索引**，则将创建唯一的**聚集索引**以强制实施 `PRIMARY KEY` 约束。

#### 2. 聚集索引

详见 [聚集索引与非聚集索引区别](./聚集索引与非聚集索引区别.html)

#### 3. 主键与聚集索引对比

|                          | **主键**                                                     | **聚集索引**                                                 |
| ------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 用途                     | 强制表的实体完整性                                           | 对数据行的排序，方便查询用                                   |
| 一个表多少个             | 一个表最多一个主键                                           | 一个表最多一个聚集索引                                       |
| 是否允许多个字段来定义   | 一个主键可以多个字段来定义                                   | 一个索引可以多个字段来定义                                   |
|                          |                                                              |                                                              |
| 是否允许 null 数据行出现 | 如果要创建的数据列中数据存在null，无法建立主键。 创建表时指定的 PRIMARY KEY 约束列隐式转换为 NOT NULL。 | 没有限制建立聚集索引的列一定必须 not null . 也就是可以列的数据是 null 参看最后一项比较 |
| 是否要求数据必须唯一     | 要求数据必须唯一                                             | 数据即可以唯一，也可以不唯一。看你定义这个索引的 UNIQUE 设置。 （这一点需要看后面的一个比较，虽然你的数据列可能不唯一，但是系统会替你产生一个你看不到的唯一列） |
|                          |                                                              |                                                              |
| 创建的逻辑               | 数据库在创建主键同时，会自动建立一个唯一索引。 如果这个表之前没有聚集索引，同时建立主键时候没有强制指定使用非聚集索引，则建立主键时候，同时建立一个唯一的聚集索引 | 如果未使用 UNIQUE 属性创建聚集索引，数据库引擎 将向表自动添加一个四字节 uniqueifier 列。 必要时，数据库引擎 将向行自动添加一个 uniqueifier 值，使每个键唯一。此列和列值供内部使用，用户不能查看或访问。 |

<br>

---

参考

- [https://blog.csdn.net/zhangsuiwen/article/details/5087154](https://blog.csdn.net/zhangsuiwen/article/details/5087154)

- [https://www.cnblogs.com/aspirant/p/8928213.html](https://www.cnblogs.com/aspirant/p/8928213.html)

